<% content_for :title, t('titles.new', :model => Product.human_name) %>

<% form_for(@product, :html => {:id => 'styled-form'}) do |f| %>

  <div id="field-set">
    <h3><span><%= t('titles.new', :model => Product.human_name)%></span></h3>
    <p>
      <%= f.label :name, Product.human_attribute_name(:name) %><br />
      <%= f.text_field :name %>
    </p>
    <p>
      <%= f.label :description, Product.human_attribute_name(:description) %><br />
      <%= f.text_field :description %>
    </p>
  </div>

  <div id="content-wrapper">

    <% content_for :tab_link, tab_link("Product Presentations")-%>
    <% content_for :tab_body do %>
      <% tabbed_body 'Product Presentations' do %>
        <h2><%= t('titles.product_presentations') %></h2>

        <div id="products">
          <span class="flow-rigth">
            <%= round_button('add', "add another product presentation",{:onclick => "TableHelper.addRowToProductsTable(\"product-presentations\", \"header_row\")"}) %>
          </span>

          <div class="clear"></div>

          <table id="product-presentations" class="default-table">
            <tbody>
              <tr id="header_row">
                <th><%= ProductPresentation.human_attribute_name(:name) %></th>
                <th><%= ProductPresentation.human_attribute_name(:description) %></th>
                <th><%= ProductPresentation.human_attribute_name(:unit_price) %></th>
                <th></th>
              </tr>
              <%= render :partial => 'products/product_presentation', :collection => @product.product_presentations %>
            </tbody>
          </table>
        </div>
      <% end -%>
    <% end -%>

    <% content_for :tab_link, tab_link("Ingredients")-%>
    <% content_for :tab_body do %>
      <% tabbed_body 'ingredients' do %>
        <% content = render :partial => 'products/ingredients' %>
        <%= render :partial => 'shared/slide_in_panel', :locals => {:button_text => "Product Ingredients", :panel_content => content} %>
      <% end -%>
    <% end -%>
    <%= render :partial => 'shared/tabbed_panel' -%>

    <div id="footer">
      <%= f.submit t('forms.create'), :class => 'big-button' %>
      <%= link_to t('forms.cancel'), products_path %>
    </div>

  </div>

<% end %>

<% content_for :javascript, javascript_include_tag("products") -%>

<% content_for :javascript do -%>
  <%= javascript_include_tag "courses" %>

  <script type="text/javascript" language="javascript" charset="utf-8">
    //<![CDATA[
    _(function () {
      var tabContainers = _('div.tabs > div');

      _('div.tabs ul.tabNavigation a').click(function () {
        tabContainers.hide().filter(this.hash).show();

        _('div.tabs ul.tabNavigation a').removeClass('selected');
        _(this).addClass('selected');

        return false;
      }).filter(':first').click();
    });
    //]]>
  </script>
<% end -%>
