<%content_for :title, "Editing Order" %>

<% form_for(@order, :html => {:id => 'styled-form'}) do |f| %>
  <%= f.error_messages %>

  <div id="header">
    <%= f.label :status %>
    <%= f.text_field :status %>
    <%= f.label :registration_date %>
    <%= f.calendar_date_select :registration_date, :popup => :force%>
    Order Number: <span><%= "#{@order.order_number}" %></span>
  </div>


  <%= render :partial => 'orders/client_form', :locals =>  { :client => @order.client }%>

  <div id="content-wrapper">
    <div id="products">
      <ul class="inline-form">
        <li class="item"><div>Quantity</div></li>
        <li class="item"><div>Name</div></li>
        <li class="item"><div>Description</div></li>
        <li class="item"><div>Unit Price</div></li>
        <li class="item"><div class="clear"></div></li>
      </ul>
      <div class="clear"></div>
      <%= render :partial => 'orders/product_presentation_form' %>
    </div>

    <span class="flow-rigth">
      <%= add_product_link "Add another product" %>
    </span>

    <div class="clear"></div>

    <span>
      <ul class="inline-form">
        <li class="item"><div><%= f.label :ammount, "Order Total" %></div></li>
        <li class="item three-item"><%= text_field "ammount", "in_words", :id => 'grant-total-words', :class => 'big-input', :value => @order.ammount.to_words %></li>
        <li class="item"><%= f.text_field :ammount, :class => 'grant-total li-input'%></li>
      </ul>
    </span>

    <div id="footer">
      <%= f.submit 'Update', :class => 'big-button' %>
      <%= link_to 'Cancel', orders_path %>
    </div>
  </div>
<% end %>


<% content_for :javascript, javascript_include_tag("clients") -%>

<script type="text/javascript">
  js = <%= @product_presentations.inject({}) { |sum, pp| sum[pp.id] = {:description => pp.description, :unit_price => pp.unit_price} ; sum}.to_json  %>;
  document.observe("dom:loaded", function() {
    // initially hide all containers for tab content
    $$('div.tabcontent').invoke('hide');
  });
</script>

<% content_for :javascript, javascript_include_tag("orders") -%>
<% content_for :javascript, javascript_include_tag("forms") -%>